{% extends "docs.html.twig" %}

{% block title %}Component: Router | Multi-app {% endblock %}

{% block description %}
    The Router component, composed of Symfony Routing, allows multiple Ratchet apps to be hosted by one server distinguished by HTTP endpoints.
{% endblock %}

{% block doc_content %}
    <h2>Router</h2>

    <section id="purpose">
        <h3>
            Purpose <small>of this <em>Component</em> <a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></small>
        </h3>

        <p>
            The Router component is composed using parts of the Symfony Routing Component.
            It allows multiple WebSocket apps to be run on the same server distinguished by HTTP endpoints.
        </p>

        <p>
            <strong>Note:</strong> This component is bundled within the App class and includes a UrlMatcher to make your life easy.
        </p>
    </section>

    <section id="events">
        <h3>
            Events <small>triggered by this <em>Component</em> <a class="headerlink" href="#events" title="Permalink to this headline">¶</a></small>
        </h3>

        <p>As found in the API Docs: Triggered events are propagated through a <a href="/api/class-Ratchet.Http.HttpServerInterface.html">HttpServerInterface</a> object passed to the <em>__construct</em>.</p>

        <ul>
            <li><span class="label label-success">onOpen</span> (ConnectionInterface <em>$conn</em>, RequestInterface $request = null) - A new client connection has been opened</li>
            <li><span class="label label-warning">onClose</span> (ConnectionInterface <em>$conn</em>) - A client connection is about to, or has closed</li>
            <li><span class="label label-info">onMessage</span> (ConnectionInterface <em>$from</em>, string <em>$message</em>) - A data message has been received</li>
            <li><span class="label label-danger">onError</span> (ConnectionInterface <em>$from</em>, Exception <em>$error</em>) - An error has occurred with a <em>Connection</em></li>
        </ul>
    </section>

    <section id="configuration">
        <h3>
            Configuration <small>properties <a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></small>
        </h3>

        <ul>
            <li><strong>$allowedOrigins</strong> - An array of strings of origins (URLs) to allow.</li>
        </ul>
    </section>

    <section id="functions">
        <h3>
            Functions <small>callable on <em>Connections</em> <a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></small>
        </h3>

        <ul>
            <li><span class="label label-info">send</span> (string <em>$message</em>) - Send a message (string) to the client</li>
            <li><span class="label label-warning">close</span> - Gracefully close the connection to the client</li>
        </ul>
    </section>

    <section id="wraps">
        <h3>
            Wraps <small>other components nicely <a class="headerlink" href="#wraps" title="Permalink to this headline">¶</a></small>
        </h3>

        <ul>
            <li><a href="/docs/websocket">WsServer</a></li>
        </ul>
    </section>

    <section id="wrapped">
        <h3>
            Wrapped <small>by other components nicely <a class="headerlink" href="#wrapped" title="Permalink to this headline">¶</a></small>
        </h3>

        <ul>
            <li><a href="/docs/http">HttpServer</a></li>
        </ul>
    </section>

    <section id="usage">
        <h3>
            Usage <small><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></small>
        </h3>

        <p>It is recommended using the Router through the App class where all the assembly is already done for you.</p>
        <p>If you want to compose everything yourself please see the <a href="http://symfony.com/doc/current/book/routing.html">Symfony Routing Documentation</a>.</p>
    </section>
{% endblock %}
